function dg_d7_services_request_pre_postprocess_alter(e,t){if("system"==e.service&&"connect"==e.resource){jDrupal.connected=!0;var r=t.user;if(r.uid){var n={uid:[{value:r.uid}],name:[{value:r.name}],mail:[{value:r.mail}],status:[{value:r.status}],created:[{value:r.created}],changed:[{value:r.changed}],access:[{value:r.access}],init:[{value:r.init}],roles:[]};for(var s in r.roles)r.roles.hasOwnProperty(s)&&n.roles.push({target_id:r.roles[s],target_type:"user_role"});jDrupal.setCurrentUser(new jDrupal.User(n))}else jDrupal.setCurrentUser(jDrupal.userDefaults())}else"user"==e.service&&"logout"==e.resource&&jDrupal.setCurrentUser(jDrupal.userDefaults())}function dg_d7_deviceready(){return d7.config("sitePath",jDrupal.config("sitePath")),new Promise(function(e,t){system_connect({success:function(t){dg.continue(),e()},error:function(t,r,n){console.log(arguments);var s="deviceready_offline";jDrupal.moduleImplements(s)?jDrupal.moduleInvokeAll(s,t,r,n):(e(),setTimeout(function(){dg.error(t,r,n)},1))}})})}function dg_d7_form_alter(e,t,r){return new Promise(function(t,n){"UserLoginForm"==r&&(e._submit=["dg_d7.user_login_form_submit"]),t()})}dg.createModule("dg_d7");var d7=dg_d7;d7.init=function(){d7.settings={sitePath:null,basePath:"/"}},d7.init(),d7.config=function(e){var t="undefined"!=typeof arguments[1]?arguments[1]:null;return t?void(d7.settings[e]=t):d7.settings[e]},d7.sitePath=function(){return d7.settings.sitePath},d7.basePath=function(){return d7.settings.basePath},d7.restPath=function(){return this.sitePath()+this.basePath()},d7.path=function(){return this.restPath().substr(this.restPath().indexOf("://")+3).replace("localhost","")},d7.entityViewController=function(e){var t={};return t.entity={_theme:"bucket",_grab:function(){return new Promise(function(t,r){var n=dg.router.getActiveRoute();entity_load(n.defaults._dgEntityType,e,{success:function(e){t(n.defaults._dgController(e))},error:function(e,r,s){t(n.defaults._dgController(null,e,r,s))}})})}},t},d7.fieldHasItem=function(e,t,r,n){return r||(r=language_default()),"undefined"==typeof n&&(n=0),e[t]&&e[t][r]&&e[t][r].length&&e[t][r][n]},d7.fieldGetItem=function(e,t,r,n){return r||(r=language_default()),"undefined"==typeof n&&(n=0),e[t][r][n]},d7.fieldGetItemCount=function(e,t,r){return r?d7.fieldGetItems(e,t,r).length:d7.fieldGetItems(e,t).length},d7.fieldGetItems=function(e,t,r){return r||(r=language_default()),e[t][r]},d7.fieldSetItem=function(e,t,r,n,s,i){s||(s=language_default()),"undefined"==typeof i&&(i=0),e[t]||(e[t]={}),r?(e[t][s]||(e[t][s]=[]),e[t][s][i]||(e[t][s][i]={}),e[t][s][i][r]=n):e[t][s][i]=n},d7.showFormErrors=function(e){var t=[],r=JSON.parse(e);if(r.form_errors)for(var n in r.form_errors)r.form_errors.hasOwnProperty(n)&&t.push(r.form_errors[n]);else t.push(e);t.length&&dg.alert(t.join("<br />"))},dg_d7.user_login_form_submit=function(e,t){return new Promise(function(e,r){user_login(t.getValue("name"),t.getValue("pass"),{success:function(t){console.log(t),e()},error:function(e,t,n){console.log(arguments),document.getElementById("edit-pass").value="",dg.alert(JSON.parse(n)[0]),r()}})})},d7.Views=function(e){this.path=e,this.results=null,this._count=null,this._page=null,this._pages=null,this._limit=null,this._pagerReady=!1},d7.Views.prototype.getPath=function(){return this.path},d7.Views.prototype.getResults=function(){return this.results},d7.Views.prototype.getCount=function(){return this._count},d7.Views.prototype.setCount=function(e){this._count=e},d7.Views.prototype.getPage=function(){return this._page},d7.Views.prototype.setPage=function(e){this._page=e},d7.Views.prototype.getPages=function(){return this._pages},d7.Views.prototype.setPages=function(e){this._pages=e},d7.Views.prototype.getLimit=function(){return this._limit},d7.Views.prototype.setLimit=function(e){this._limit=e},d7.Views.prototype.hasPages=function(){return!!this.getPages()},d7.Views.prototype.setPager=function(e){this._pager=e},d7.Views.prototype.getPager=function(){return this._pager},d7.Views.prototype.pagerReady=function(){return!!this.getPager()},d7.Views.prototype.getView=function(){var e=this;return new Promise(function(t,r){var n=new XMLHttpRequest;n.dg={service:"views",resource:null};var s=d7.restPath()+e.getPath(),i=null!==e.getPage()?e.getPage():dg._GET("page");i&&(s+=(s.indexOf("?")==-1?"?":"&")+"page="+i),n.open("GET",s);var o=function(){e.results=[];var r=JSON.parse(n.response),s=r.view;if(e.setCount(s.count),e.setPage(s.page),e.setPages(s.pages),e.setLimit(s.limit),r.view.count)for(var i in r[r.view.root])r[r.view.root].hasOwnProperty(i)&&e.results.push(r[r.view.root][i][r.view.child]);t()};n.onload=function(){if(200==n.status){var e=jDrupal.moduleInvokeAll("rest_post_process",n);e?e.then(o):o()}else r(Error(n.statusText))},n.onerror=function(){r(Error("Network Error"))},n.send()})},d7.viewsLoad=function(e){return new Promise(function(t,r){var n=new d7.Views(e);n.getView().then(function(){t(n)})})};